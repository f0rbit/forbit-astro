---
import type { Project, ApiResult } from '../../types'
import ProjectCard from '../ProjectCard.astro'

interface Props {
    select: string[] | null,
    projects?: Project[]
    
}
/** @todo pass the array as a filter to the API */

const { projects, select } = Astro.props

const data = projects ? projects : (await (await fetch(import.meta.env.PROJECT_URL)).json() as ApiResult<Project[]>)?.data ?? [];

// need the as Project[] because tsserver can't detect that the filter is removing the undefined projects
let filtered = select ? select.map((project_id) => data.find((project) => project.project_id == project_id)).filter(Boolean) as Project[] : data;
---

{filtered.map((project) => <ProjectCard project={project} />)}
